<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Netfilter Overview</title>
<meta name="Microsoft Theme" content="radial 011, default">
</head>

<body background="_themes/radial/radbkgnd.gif" bgcolor="#FFFFFF" text="#000000" link="#6666FF" vlink="#993333" alink="#66CCCC"><!--mstheme--><font face="arial, Arial, Helvetica">

<h1 align="center"><!--mstheme--><font face="times new roman, Times New Roman, Times" color="#666666">Netfilter Overview<!--mstheme--></font></h1>
<div align="left">
  <p align="left">&nbsp;</div>
<h2 align="left"><!--mstheme--><font face="times new roman, Times New Roman, Times" color="#666666">1.0 Tables<!--mstheme--></font></h2>

<p align="left"><i>Chains</i> of <i>rules </i>are organized into <i>Tables.</i> 
Netfilter currently has three tables.</p>

<ol>
  <li>
<p align="left">Mangle Table - This allows the contents of the packet to be 
changed. Shorewall uses rules in this table to mark packets for traffic 
shaping/control (/etc/shorewall/tcrules file) and for setting the Type of 
Service (TOS) for the packet (/etc/shorewall/tos).</p>

  </li>
  <li>
<p align="left">NAT Table - Allows modification of the source and destination IP 
and port.</p>

  </li>
  <li>
<p align="left">Filter Table - This is where most ACCEPT/DROP/REJECT decisions 
are made in Shorewall.</p>

  </li>
</ol>
<p align="left">Each table has a number of <i>pre-defined chains</i> as shown in 
the table that follows. Packets flow through the chains in the order of that 
table.</p>

<blockquote>
  <!--mstheme--></font><table border="1" style="border-collapse: collapse" cellpadding="2" id="AutoNumber10" width="895" bordercolordark="#666666" bordercolorlight="#CCCCCC">
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica"><u><b>Ordinal</b></u><!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica"><u><b>Table</b></u><!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica"><u><b>Chain</b></u><!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica"><u><b>Shorewall Usage</b></u><!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica"><u><b>Comments</b></u><!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica">1<!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica">Mangle<!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica">PREROUTING<!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica">
      <ol>
        <li>RFC 1918 Destination Rejections</li>
        <li>Marking Packets for Traffic Control</li>
        <li>TOS</li>
      </ol>
      <!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica">&nbsp;<!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica">2<!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica">NAT<!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica">PREROUTING<!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica">
      <ol>
        <li>DNAT Rules</li>
        <li>Static NAT DNAT mapping</li>
      </ol>
      <!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica">Only connection requests go here -- packets that are part of or 
      related to an established connection use information from the connection 
      tracking table.<!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica">3<!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica">Filter<!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica">INPUT<!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica"><i>&lt;zone&gt;</i>2<b>fw</b> filtering<!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica">&nbsp;<!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica">3<!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica">Filter<!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica">FORWARD<!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica"><i>&lt;zone&gt;</i>2<i>&lt;zone&gt;</i> filtering<!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica">&nbsp;<!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica">3<!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica">Filter<!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica">OUTPUT<!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica"><b>fw</b>2<i>&lt;zone&gt;</i> filtering<!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica">&nbsp;<!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica">4<!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica">Mangle<!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica">POSTROUTING<!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica">TOS<!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica">&nbsp;<!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica">5<!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica">NAT<!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica">OUTPUT<!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica">DNAT rules where the source zone is <b>fw</b><!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica">Only connection requests go here -- packets that are part of or 
      related to an established connection use information from the connection 
      tracking table.<!--mstheme--></font></td>
    </tr>
    <tr>
      <td width="50"><!--mstheme--><font face="arial, Arial, Helvetica">5<!--mstheme--></font></td>
      <td width="51"><!--mstheme--><font face="arial, Arial, Helvetica">NAT<!--mstheme--></font></td>
      <td width="112"><!--mstheme--><font face="arial, Arial, Helvetica">POSTROUTING<!--mstheme--></font></td>
      <td width="346"><!--mstheme--><font face="arial, Arial, Helvetica">
      <ol>
        <li>Masquerading (/etc/shoreawll/masq)</li>
        <li>SNAT (/etc/shorewall/masq)</li>
        <li>Static NAT SNAT Mapping</li>
      </ol>
      <!--mstheme--></font></td>
      <td width="310"><!--mstheme--><font face="arial, Arial, Helvetica">Only connection requests go here -- packets that are part of or 
      related to an established connection use information from the connection 
      tracking table.<!--mstheme--></font></td>
    </tr>
  </table><!--mstheme--><font face="arial, Arial, Helvetica">
</blockquote>
<p align="left">The connection tracking table can be displayed using the 
&quot;shorewall show connections&quot; command.</p>

<!--mstheme--></font></body>

</html>
